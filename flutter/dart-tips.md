---
title: Dart-tips
---

# Dart 的特性

## JIT与AOT

>JIT（Just In Time，即时编译）：在运行时即时编译，在开发周期中使用，可以动态下发和执行代码，并发测试效率高，但运行速度和执行性能则会因为运行时即时编译受到影响
>
>AOT（Ahead of Time，运行前编译）：提前编译，可以生成被直接执行的二进制代码，运行速度快，执行性能表现好，但每次执行前都需要提前编译，开放测试效率低

Flutter最受欢迎的功能之一热重载，正是基于JIT特性，而在发布期使用AOT，就不需要像`React Native`那样在跨平台`JavaScript`代码和原生`Android`、`iOS`代码之间建立低效的方法调用映射关系，所以说，**Dart具有运行速度快、执行性能好的特点**。

## 内存分配与垃圾回收

### 内存分配

Dart VM的内存分配策略比较简单，创建对象时只需要在堆上移动指针，内存增长始终是线性的，省去查找可用内存的过程。**在Dart中，并发是通过Isolate（隔离区）实现的**，Isolate是类似于线程但不共享内存，独立运行的woker。这样的机制，可以让Dart实现无锁的快速分配。

### 垃圾回收

Dart的垃圾回收，采用了多生代算法。新生代在回收内存时采用“半空间”机制，触发垃圾回收时，Dart会将当前半空间中的“活跃”对象拷贝备用空间，然后整体释放当前空间的所有内存。回收过程中，Dart只需要操作少量的“活跃”对象，没有引用的大量“死亡”对象则被忽略，这样的回收机制很适合Flutter框架中大量Widget销毁重建的场景。

## 单线程模型

支持并发执行线程的高级语言（比如，C++、Java、Objective-C），大都以抢占式的方式切换线程，即每个线程都会被分配一个固定的时间片来执行，超过了时间片后线程上下文将被抢占后切换，如果这时正在更新线程间的共享资源，抢占后就可能导致数据不同步的问题。解决这一个问题的典型办法是，使用锁来保护共享资源，但锁本身又可能会带来性能损耗，甚至出现死锁等更严重的问题。

Dart单线程模型的优势：不存在资源竞争和状态同步的问题，这就意味着一旦某个函数开始执行，就将执行到这个函数结束，而不会被其他Dart代码打断，所以**Dart中没有线程，只有Isolate（隔离区）**。Isolates之间不会共享内存，就像几个运行在不同进程中的worker，通过事件循环（Event Looper）在事件队列（Event Queue）上传递消息通信。

## 无需单独的声明式布局语言

1. var;//关键词，可以接收任何类型的变量，Dart中var变量一旦赋值，类型便会确定，则不能再改变其类型(Dart是一个强类型语言，区别js)

2. dynamic;//关键词，动态任意类型，**编译阶段不检查**类型，并且可以在后期改变赋值类型

3. Object;//动态任意类型，**编译阶段**检查类型，Dart所有对象的根基类(包括Function和Null)

4. final和const;//常量，const变量是一个编译时常量，final变量在第一次使用时被初始化

5. 函数

6. 异步支持，待实际编码过程中学习

7. 在Dart语言中使用下划线前缀标识符，会强制其变成私有的，如：_suggestions

8. 语法 "i ~/ 2" 表示i除以2，但返回值是整形（向下取整）

9. => 箭头函数：可以有返回值，返回值就是这条语句的值

10. @immutable：
        来源：https://api.flutter.dev/flutter/meta/immutable-constant.html
        说明：被@immutable注解标明的类或者子类都必须是不可变的

11. class get set方法

    ```dart
    class User {
      String _userName;
      set uesrName(String userName) => _userName = userName;
      String get userName => _userName;
    }
    ```

12. with(混入mixins)

    https://juejin.im/post/6844903764441202702